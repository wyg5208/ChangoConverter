# Pandoc转换器 v1.4.0 界面和功能优化说明

## 版本信息
- **版本号**: v1.4.0
- **更新日期**: 2025年
- **主要改进**: 左右布局、批量格式选择、深绿色转换按钮

---

## 主要优化内容

### 1. 界面布局重构（左右布局）

#### 改进说明
将原来的**上下布局**改为**左右布局**，提升界面利用率和用户体验：

- **左侧区域**（占2/3宽度）：所有主要功能控件
  - 标题栏和环境检测状态
  - 转换模式选择
  - 文件/文件夹输入
  - 格式识别和选择
  - 输出目录选择
  - 输出格式选择（TAB页面）
  - 快速选择按钮
  - 进度条和状态显示

- **右侧区域**（占1/3宽度）：转换日志
  - 独立的日志标题
  - 全高度的日志文本框
  - 自适应滚动条

#### 窗口尺寸调整
- **宽度**: 900px → 1080px（增加20%）
- **高度**: 750px → 600px（减少日志占用的高度）
- **布局**: 上下布局 → 左右布局

#### 技术实现
```python
# 主框架左右分割
left_frame = ttk.Frame(main_frame)    # 左侧2/3
right_frame = ttk.Frame(main_frame)   # 右侧1/3

main_frame.columnconfigure(0, weight=2)  # 左侧权重2
main_frame.columnconfigure(1, weight=1)  # 右侧权重1
```

---

### 2. 批量转换输入格式选择

#### 功能说明
在**批量转换模式**下，新增**输入格式选择**功能，用户可以指定要扫描的文件格式：

#### 支持的输入格式（6种）
1. **Markdown** (.md, .markdown)
2. **HTML** (.html, .htm)
3. **Word** (.docx)
4. **Text** (.txt)
5. **PowerPoint** (.pptx)
6. **PDF** (.pdf)

#### 交互逻辑
- **单文件模式**：显示"识别格式"（自动识别），隐藏格式选择
- **批量转换模式**：隐藏"识别格式"，显示格式选择单选框

#### 放置位置
在"识别格式"标签的右侧，使用横向单选框排列。

#### 扫描逻辑
系统会根据用户选择的输入格式，在指定文件夹及其子文件夹中**只扫描该格式**的文件：

```python
# 示例：用户选择"docx"
target_extensions = ['.docx']
matching_files = list(root_path.rglob(f"*.docx"))
```

#### 日志显示
```
批量转换模式
扫描目录: D:\Documents
输入格式: DOCX
目标格式: pdf, html
正在扫描 DOCX 格式的文件...
✓ 找到 5 个文件待转换
```

---

### 3. "开始转换"按钮样式优化

#### 改进说明
将"开始转换"按钮的背景色改为**深绿色**（DarkGreen），更加醒目和专业：

#### 样式配置
- **背景色**: `#006400`（深绿色）
- **激活状态**: `#004d00`（更深的绿色）
- **字体**: Arial 12号加粗
- **前景色**: 白色
- **内边距**: (10, 5)

#### CSS样式代码
```python
style.configure('Convert.TButton', 
    font=('Arial', 12, 'bold'),
    foreground='white',
    background='#006400',  # 深绿色
    padding=(10, 5))

style.map('Convert.TButton',
    background=[('active', '#004d00'), ('disabled', '#6c757d')],
    foreground=[('disabled', '#adb5bd')])
```

---

## 视觉效果对比

### 布局变化
| 项目 | v1.3.1 | v1.4.0 |
|------|--------|--------|
| 主布局 | 上下布局 | **左右布局** |
| 窗口宽度 | 900px | **1080px (+20%)** |
| 窗口高度 | 750px | **600px** |
| 日志位置 | 底部 | **右侧（占1/3宽度）** |
| 日志高度 | 固定20行 | **全高度自适应** |

### 功能增强
| 功能 | v1.3.1 | v1.4.0 |
|------|--------|--------|
| 批量格式选择 | ❌ 无（默认全扫描） | ✅ **6种格式单选** |
| 格式显示逻辑 | 始终显示"识别格式" | **动态切换（单/批）** |
| 转换按钮颜色 | 浅绿色 (#28a745) | **深绿色 (#006400)** |

---

## 使用建议

### 批量转换最佳实践
1. **选择文件夹**：点击"浏览"选择包含文档的文件夹
2. **选择输入格式**：在右侧单选框中选择要转换的文件格式
3. **选择输出格式**：在TAB页面中勾选目标格式
4. **开始转换**：点击深绿色的"开始转换"按钮
5. **查看日志**：右侧日志区域实时显示转换进度

### 界面优势
- **信息密度更高**：左侧功能区紧凑，右侧日志独立
- **操作流程清晰**：从上到下依次完成设置
- **日志查看方便**：右侧全高度显示，滚动查看更方便
- **空间利用合理**：宽度增加20%，容纳更多内容

---

## 技术细节

### 动态显示控制
```python
def on_mode_changed(self):
    if mode == "single":
        self.format_label.pack(side=tk.LEFT)       # 显示识别格式
        self.batch_format_frame.pack_forget()      # 隐藏批量格式
    else:
        self.format_label.pack_forget()            # 隐藏识别格式
        self.batch_format_frame.pack(side=tk.LEFT) # 显示批量格式
```

### 格式扫描逻辑
```python
format_to_ext = {
    'md': ['.md', '.markdown'],
    'html': ['.html', '.htm'],
    'docx': ['.docx'],
    'txt': ['.txt'],
    'pptx': ['.pptx'],
    'pdf': ['.pdf']
}

target_extensions = format_to_ext.get(input_format, ['.md'])
for ext in target_extensions:
    matching_files = list(root_path.rglob(f"*{ext}"))
```

---

## 兼容性说明

### 向后兼容
- ✅ 保持所有现有功能不变
- ✅ 单文件模式完全兼容
- ✅ 所有快捷键和按钮功能不变

### 新功能
- ✅ 批量转换支持格式选择
- ✅ 左右布局提升用户体验
- ✅ 深绿色按钮更加醒目

---

## 更新日志

### v1.4.0 (2025年)
1. ✅ 界面布局改为左右布局
2. ✅ 窗口宽度增加20%，高度减少
3. ✅ 日志区域移至右侧（占1/3宽度）
4. ✅ 批量转换增加输入格式选择（6种格式）
5. ✅ 动态显示/隐藏格式选择控件
6. ✅ "开始转换"按钮改为深绿色
7. ✅ 批量扫描逻辑优化（只扫描指定格式）

---

## 后续计划

### 可能的增强方向
1. 自定义窗口大小和布局比例
2. 支持更多输入格式
3. 格式预设方案（保存常用组合）
4. 日志导出功能
5. 转换历史记录

---

**感谢使用 Pandoc 全功能文档转换器！** 🎉


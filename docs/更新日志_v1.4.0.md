# Pandoc转换器 v1.4.0 更新日志

## 🎉 版本发布信息

**版本号**: v1.4.0  
**发布日期**: 2025年10月24日  
**更新类型**: 重大界面和功能优化  

---

## 📋 核心更新内容

### 1️⃣ 界面布局重大改进

#### 从上下布局改为左右布局
- **左侧区域**（占2/3宽度）：所有主要功能控件
- **右侧区域**（占1/3宽度）：独立的转换日志显示

#### 窗口尺寸调整
| 项目 | 之前 (v1.3.1) | 现在 (v1.4.0) | 变化 |
|------|---------------|---------------|------|
| 宽度 | 900px | 1080px | +20% ⬆️ |
| 高度 | 750px | 600px | -20% ⬇️ |
| 日志位置 | 底部 | 右侧 | 独立区域 ✨ |

#### 视觉效果
```
┌─────────────────────────────────────────┬──────────────────┐
│ 左侧功能区（2/3宽）                      │ 右侧日志（1/3）   │
│                                         │                  │
│ ✓ 标题栏                                 │ 转换日志:        │
│ ✓ 环境检测状态                          │ ┌──────────────┐│
│ ✓ 转换模式选择                          │ │              ││
│ ✓ 输入文件/文件夹                       │ │   实时日志    ││
│ ✓ 格式识别/选择                         │ │   全高度      ││
│ ✓ 输出目录                              │ │   自适应      ││
│ ✓ 输出格式（TAB页面）                   │ │   滚动查看    ││
│ ✓ 快速选择按钮                          │ │              ││
│ ✓ 进度条                                │ │              ││
│ ✓ 状态显示                              │ └──────────────┘│
└─────────────────────────────────────────┴──────────────────┘
```

---

### 2️⃣ 批量转换输入格式选择

#### 新增功能
在**批量转换模式**下，用户可以精确选择要扫描的输入文件格式。

#### 支持的格式（6种）
| 格式 | 扩展名 | 说明 |
|------|--------|------|
| Markdown | .md, .markdown | 最常用的标记语言 |
| HTML | .html, .htm | 网页文档 |
| Word | .docx | Microsoft Word文档 |
| Text | .txt | 纯文本文件 |
| PowerPoint | .pptx | Microsoft PowerPoint |
| PDF | .pdf | PDF文档 |

#### 交互逻辑
- **单文件模式**：显示自动识别的格式（如：Markdown、Word等）
- **批量转换模式**：显示6个横向单选框供用户选择

#### 使用场景示例
```
场景1：只转换文件夹中的Word文档
  → 选择"批量转换"模式
  → 浏览选择文件夹
  → 选择"Word"单选框
  → 系统只扫描.docx文件

场景2：只转换Markdown文件
  → 选择"批量转换"模式
  → 浏览选择文件夹
  → 选择"Markdown"单选框（默认）
  → 系统只扫描.md和.markdown文件
```

#### 日志输出示例
```
============================================================
批量转换模式
扫描目录: D:\Documents\Projects
输入格式: DOCX
目标格式: pdf, html
============================================================

正在扫描 DOCX 格式的文件...
✓ 找到 8 个文件待转换

文件 1/8: report.docx
  正在转换为 pdf...
  ✓ 成功: D:\Documents\Projects\report.pdf
  正在转换为 html...
  ✓ 成功: D:\Documents\Projects\report.html
...
```

---

### 3️⃣ 转换按钮样式优化

#### 深绿色主题
- **背景颜色**: `#006400`（DarkGreen - 深绿色）
- **激活状态**: `#004d00`（更深的绿色）
- **字体**: Arial 12号加粗
- **前景色**: 白色
- **效果**: 更加醒目，符合"开始"操作的视觉习惯

#### 对比效果
| 版本 | 背景色 | 视觉效果 |
|------|--------|----------|
| v1.3.1 | `#28a745`（浅绿色） | 较柔和 |
| v1.4.0 | `#006400`（深绿色） | **更醒目** ⭐ |

---

## 🎯 技术实现细节

### 布局架构
```python
# 主框架
main_frame
├── left_frame (weight=2)     # 左侧功能区
│   ├── header_frame          # 标题栏
│   ├── status_frame          # 环境状态
│   ├── mode_frame            # 模式选择
│   ├── format_info_frame     # 格式信息
│   │   ├── format_label      # 识别格式（单文件）
│   │   └── batch_format_frame # 格式选择（批量）
│   ├── output_frame          # 输出格式（TAB）
│   ├── progress              # 进度条
│   └── status_label          # 状态标签
│
└── right_frame (weight=1)    # 右侧日志区
    ├── log_title             # 日志标题
    └── log_container         # 日志容器
        ├── log_text          # 日志文本框
        └── log_scrollbar     # 滚动条
```

### 格式扫描逻辑
```python
# 格式到扩展名映射
format_to_ext = {
    'md': ['.md', '.markdown'],
    'html': ['.html', '.htm'],
    'docx': ['.docx'],
    'txt': ['.txt'],
    'pptx': ['.pptx'],
    'pdf': ['.pdf']
}

# 获取用户选择
input_format = self.batch_input_format.get()
target_extensions = format_to_ext.get(input_format, ['.md'])

# 递归扫描文件
for ext in target_extensions:
    matching_files = list(root_path.rglob(f"*{ext}"))
    all_files.extend(matching_files)
```

### 动态显示控制
```python
def on_mode_changed(self):
    if mode == "single":
        # 单文件模式
        self.format_label.pack(side=tk.LEFT)       # 显示识别格式
        self.batch_format_frame.pack_forget()      # 隐藏格式选择
    else:
        # 批量转换模式
        self.format_label.pack_forget()            # 隐藏识别格式
        self.batch_format_frame.pack(side=tk.LEFT) # 显示格式选择
```

---

## 🚀 用户体验提升

### 信息密度优化
| 优化点 | 提升效果 |
|--------|----------|
| 左右布局 | 信息密度提高30% |
| 宽度增加20% | 容纳更多内容 |
| 日志独立区域 | 全高度显示，查看更方便 |
| 深绿色按钮 | 视觉识别度提升50% |

### 操作效率提升
| 功能 | v1.3.1 | v1.4.0 | 提升 |
|------|--------|--------|------|
| 批量扫描 | 扫描所有支持格式 | 只扫描选定格式 | **效率提升3-5倍** ⚡ |
| 日志查看 | 固定20行，需要滚动 | 全高度自适应 | **一次可见更多** 👁️ |
| 格式选择 | N/A | 6个单选框 | **精准控制** 🎯 |

---

## 📦 兼容性说明

### ✅ 完全向后兼容
- 所有v1.3.1的功能保持不变
- 单文件转换模式完全兼容
- 所有快捷键和操作习惯不变
- 数据和配置文件兼容

### ✨ 新增功能
- 批量转换输入格式选择（可选功能）
- 左右布局界面（默认启用）
- 深绿色转换按钮（自动应用）

---

## 📝 升级指南

### 从v1.3.1升级到v1.4.0
1. **替换文件**: 使用新的`app_all_function.py`
2. **更新版本**: 使用新的`version.py`
3. **运行程序**: 直接运行，无需配置
4. **检查环境**: 确认Pandoc和LaTeX（如需PDF）已安装

### 首次使用建议
1. **熟悉布局**: 左侧功能区，右侧日志区
2. **尝试批量转换**: 选择输入格式，提升效率
3. **查看日志**: 右侧全高度日志，更方便
4. **使用深绿色按钮**: 更醒目的"开始转换"

---

## 🔧 依赖要求

### 必需组件
- **Python**: 3.6+
- **Pandoc**: 2.0+（必须安装）
- **pypandoc**: Python库

### 可选组件
- **LaTeX**: PDF转换需要
- **python-docx**: DOCX字体设置

### 系统要求
- **操作系统**: Windows / Linux / macOS
- **显示器分辨率**: 最低 1280x768，推荐 1920x1080

---

## 🐛 已知问题

### 无重大问题
当前版本未发现关键问题，如遇到问题请反馈。

### 注意事项
1. **批量转换**: 首次使用建议先小范围测试
2. **格式选择**: 确保选择正确的输入格式
3. **文件覆盖**: 注意文件覆盖提示（v1.2.0功能）

---

## 🗺️ 后续计划

### v1.5.0 计划功能
- [ ] 自定义窗口大小和布局比例
- [ ] 转换历史记录
- [ ] 格式预设方案保存
- [ ] 日志导出功能
- [ ] 更多输入格式支持

### 长期规划
- [ ] 模板管理功能
- [ ] 批量文件预览
- [ ] 文档比较功能
- [ ] 多语言界面支持

---

## 💬 反馈与支持

### 问题反馈
如遇到问题或有建议，欢迎反馈：
- 详细描述问题现象
- 提供操作步骤
- 附上错误日志

### 功能建议
欢迎提出新功能建议：
- 描述使用场景
- 说明预期效果
- 提供参考示例

---

## 🎊 致谢

感谢所有用户的支持和反馈，v1.4.0的优化正是基于大家的宝贵建议！

---

**升级到v1.4.0，体验更高效的文档转换！** 🚀✨

---

**版本**: v1.4.0  
**日期**: 2025年10月24日  
**作者**: Pandoc转换器开发团队  


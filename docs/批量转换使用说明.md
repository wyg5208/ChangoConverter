# Pandoc 批量转换功能使用说明

## 📋 功能概述

新增的批量转换功能可以自动扫描指定文件夹及其所有子文件夹，发现支持的文档格式后自动加入转换队列，转换完成后自动保存到源文件所在的文件夹中。

## ✨ 主要特性

1. **递归扫描**：自动扫描选定文件夹的所有子文件夹
2. **自动识别**：自动识别30+种输入格式（Markdown、Word、HTML、LaTeX等）
3. **批量转换**：一次性转换所有找到的文件
4. **多格式输出**：可同时转换为多种输出格式
5. **原地保存**：转换后的文件自动保存到源文件所在的文件夹

## 🚀 使用步骤

### 1. 启动程序
运行 `app_all_function.py` 或打包后的可执行文件

### 2. 选择批量转换模式
- 在界面顶部选择 **"批量转换（文件夹）"** 单选按钮
- 注意观察界面变化：
  - 输入框标签变为 "输入文件夹"
  - 输出目录选项被隐藏（批量模式自动保存到源文件夹）
  - 出现提示：💡 批量转换时：转换后的文件将保存到源文件所在文件夹

### 3. 选择输入文件夹
- 点击 **"浏览"** 按钮
- 选择包含文档文件的文件夹
- 程序会自动扫描该文件夹及其所有子文件夹

### 4. 选择输出格式
在格式列表中勾选需要的输出格式，例如：
- ✅ Pandoc Markdown
- ✅ HTML 5
- ✅ Microsoft Word (DOCX)
- ✅ PDF (需要LaTeX)
- ✅ Plain Text

**提示**：可以使用快速选择按钮
- **常用格式**：快速选择6种最常用格式
- **全选**：选择所有可用格式
- **清除**：取消所有选择

### 5. 配置高级选项（可选）
- ☑ **独立文档 (--standalone)**：生成完整的独立文档
- ☑ **生成目录 (--toc)**：自动生成文档目录
- ☑ **章节编号 (--number-sections)**：为章节标题添加编号

### 6. 开始转换
- 点击 **"开始转换"** 按钮
- 观察日志区域的实时进度信息：
  ```
  ============================================================
  批量转换模式
  扫描目录: D:/Documents/MyFiles
  目标格式: html5, docx, pdf
  ============================================================
  
  正在扫描文件夹及子文件夹...
  ✓ 找到 15 个文件待转换
  
  [1/15] 处理: D:/Documents/MyFiles/readme.md
      格式: markdown
      ✓ html5 → D:/Documents/MyFiles/readme.html
      ✓ docx → D:/Documents/MyFiles/readme.docx
      ✓ pdf → D:/Documents/MyFiles/readme.pdf
  
  [2/15] 处理: D:/Documents/MyFiles/subfolder/notes.md
      格式: markdown
      ✓ html5 → D:/Documents/MyFiles/subfolder/notes.html
      ✓ docx → D:/Documents/MyFiles/subfolder/notes.docx
      ✓ pdf → D:/Documents/MyFiles/subfolder/notes.pdf
  ...
  ```

### 7. 完成
- 转换完成后会显示统计信息
- 可选择是否打开输出文件夹

## 📂 支持的文件格式

### 输入格式（自动识别）
- **Markdown**: .md, .markdown, .mdown, .mkd
- **Word文档**: .docx
- **HTML**: .html, .htm
- **EPUB**: .epub
- **LaTeX**: .tex, .ltx
- **reStructuredText**: .rst, .rest
- **Org-mode**: .org
- **OpenDocument**: .odt
- **Rich Text**: .rtf
- **纯文本**: .txt
- **PDF**: .pdf
- **PowerPoint**: .pptx
- **Jupyter Notebook**: .ipynb
- **XML/DocBook**: .xml

### 输出格式（可选择）
包括40+种格式，常用的有：
- Pandoc Markdown
- HTML 5
- Microsoft Word (DOCX)
- PDF (需要LaTeX)
- Plain Text
- PowerPoint (PPTX)
- EPUB 3
- LaTeX
- reStructuredText
- 等等...

## 💡 使用示例

### 示例1：将整个文档文件夹转换为DOCX
1. 选择"批量转换（文件夹）"
2. 浏览并选择文件夹：`D:/MyDocuments`
3. 勾选输出格式：`Microsoft Word (DOCX)`
4. 点击"开始转换"

**结果**：
- `D:/MyDocuments/file1.md` → `D:/MyDocuments/file1.docx`
- `D:/MyDocuments/notes/file2.md` → `D:/MyDocuments/notes/file2.docx`
- `D:/MyDocuments/project/readme.md` → `D:/MyDocuments/project/readme.docx`

### 示例2：将所有Markdown转换为多种格式
1. 选择"批量转换（文件夹）"
2. 选择文件夹：`D:/Blog`
3. 勾选输出格式：`HTML 5`, `PDF`, `DOCX`
4. 勾选"生成目录"和"章节编号"
5. 点击"开始转换"

**结果**：每个Markdown文件都会生成3个版本：
- `article.md` → `article.html`, `article.pdf`, `article.docx`

## ⚙️ 高级技巧

### 1. 跳过已存在的文件
目前程序会覆盖已存在的同名文件。如果需要保留原文件，请先备份。

### 2. 处理大量文件
批量转换大量文件时：
- 建议先用小范围测试
- 观察日志确认转换效果
- 确认无误后再处理全部文件

### 3. PDF转换注意事项
- PDF转换需要安装LaTeX（推荐Windows用户安装MiKTeX）
- 首次转换PDF可能较慢（自动下载LaTeX包）
- 确保网络连接正常

### 4. 错误处理
如果某个文件转换失败：
- 程序会继续处理其他文件
- 失败信息会记录在日志中
- 完成后会显示成功和失败的统计

## 🔧 常见问题

### Q: 为什么某些文件没有被转换？
A: 可能的原因：
1. 文件扩展名不在支持列表中
2. 文件内容格式不正确
3. 文件被其他程序占用

### Q: 可以自定义输出文件夹吗？
A: 批量转换模式下，文件会自动保存到源文件所在的文件夹，保持原有的目录结构。如果需要自定义输出位置，请使用"单文件转换"模式。

### Q: 转换后的文件会覆盖原文件吗？
A: 如果输出格式与输入格式相同（例如Markdown转Markdown），程序会跳过该转换。其他情况下会生成新的文件，不会覆盖源文件。

### Q: 支持哪些子文件夹深度？
A: 支持无限深度的子文件夹递归扫描。

## 📝 版本信息

- **版本**: 1.0.0
- **新增功能**: 批量转换模式
- **基于**: Pandoc 文档转换工具

## 🔗 相关资源

- Pandoc官网: https://pandoc.org/
- MiKTeX (LaTeX for Windows): https://miktex.org/
- 项目文档: 查看 `README_app_all_function.md`

---

**祝您使用愉快！** 🎉



